# YouTube Slicer Chrome Extension 開發任務列表

## 1. 專案初始化與環境設定
- [ ] 建立 Chrome Extension 專案結構 (manifest.json, popup.html, popup.js, content_script.js, background.js)。
- [ ] 配置 `manifest.json` 檔案，定義權限 (activeTab, storage) 和入口點。
- [ ] 確保 extension 只在 YouTube 網域啟動。
- [ ] 設定開發環境，確保可以載入和測試擴充功能。

## 2. UI/UX 設計與實現 (浮動視窗、按鈕、時間標記列表、分頁)
- [ ] **浮動視窗 (Overlay) 實現:**
    - [ ] 創建 `content_script.js`，用於在 YouTube 頁面中注入浮動視窗。
    - [ ] 實現 CSS 樣式，將浮動視窗定位在頁面右側，寬度 30%，高度 90%。
    - [ ] 操作視窗預設為不顯示 (需由功能設定啟用)。
    - [ ] 確保浮動視窗在頁面滾動時保持固定位置。
- [ ] **啟用/關閉紀錄開關 (在 Extension Popup 中):**
    - [ ] 在 `popup.html` 中設計並實現一個開關按鈕 (Toggle button) 用於啟用/關閉「紀錄時間」功能。
    - [ ] 在 `popup.html` 中同步顯示已記錄的時間標記清單 (完整列表，分頁顯示，與浮動視窗保持一致)。
    - [ ] 啟用時顯示狀態文字「已啟動」，關閉時顯示「已關閉」。
    - [ ] 實現 `background.js` 或 `popup.js` 邏輯，保存開關狀態並通知 `content_script.js` 是否允許記錄。
- [ ] **主要控制按鈕實現:**
    - [ ] 設計並實現三個按鈕：
        - [ ] **記錄 (Record) 按鈕:** 用於記錄當前影片播放時間點的網址。
    - [ ] **清除 (Clear) 按鈕:** 清除所有已記錄的時間標記。
    - [ ] **匯出 (Export) 按鈕:** 將所有記錄的時間標記匯出為 CSV。
    - [ ] **匯入 (Import) 按鈕:** 放在匯出按鈕旁，提供匯入時間標記的入口。
- [ ] **時間標記列表顯示:**
    - [ ] 實現一個區域用於顯示已記錄的時間標記按鈕列表。
    - [ ] 每個標記顯示為長條形按鈕，文字格式為 `SN hh:mm:ss:fff`。
    - [ ] 實作時間戳記點擊事件，點擊後影片跳轉到該時間點。
- [ ] **分頁功能實現:**
    - [ ] 當時間標記數量超過一頁顯示範圍時，實現分頁功能。
    - [ ] 設計並實現左右箭頭按鈕用於切換頁面。
    - [ ] 顯示當前頁碼和總頁數 (例如：`1/n 頁`)。
    - [ ] 當只有一頁或無資料時，隱藏或停用左右箭頭與頁碼標記。

## 3. 核心功能實現
- [ ] **記錄時間標記:**
    - [ ] 當「記錄」按鈕被點擊時，獲取當前 YouTube 影片的 URL 和播放時間 (包括毫秒)。
    - [ ] 若「啟用紀錄」為關閉狀態，則不新增記錄，並顯示對應提示或日誌。
    - [ ] 將完整的含時間標記的 URL (例如：`https://www.youtube.com/watch?v=VIDEO_ID&t=XsYms`) 儲存起來。
    - [ ] 考慮使用 Chrome `storage` API 來持久化儲存時間標記。
    - [ ] 將新記錄的時間標記動態添加到列表中。
- [ ] **清除記錄:**
    - [ ] 當「清除」按鈕被點擊時，清除所有已儲存的時間標記。
    - [ ] 更新 UI，清空時間標記列表。
- [ ] **匯出記錄:**
    - [ ] 當「匯出」按鈕被點擊時，將所有儲存的時間標記整理成 CSV 格式。
    - [ ] 提供下載功能，讓使用者可以儲存匯出檔案。
    - [ ] CSV 欄位為 `SN,URL`，其中 `SN` 為序號 (由 1 開始)。
- [ ] **匯入記錄:**
    - [ ] 當「匯入」按鈕被點擊時，提供匯入 CSV 的操作流程。
    - [ ] 若已有既有內容，先詢問使用者是否覆蓋；確認後以匯入內容取代現有資料。
    - [ ] 解析 CSV 欄位 `SN,URL`，補齊或重排序號以維持一致性。
    - [ ] 檢查匯入格式是否符合 `<index>, <youtube URL>`，不符合時給出錯誤提示並中止匯入。
    - [ ] 匯入後更新儲存資料與時間標記列表。
- [ ] **點擊標記播放:**
    - [ ] 為每個時間標記按鈕添加點擊事件監聽器。
    - [ ] 點擊按鈕時，導航或更新當前 YouTube 頁面的 URL，使其跳轉到該時間點。
    - [ ] 確保跳轉功能在不同 YouTube 影片連結格式下都能正常運作。

## 4. 日誌記錄功能
- [ ] 實作統一的日誌記錄機制 (例如：使用 `console.log` 或更完善的日誌庫)。
- [ ] 確保所有按鈕動作、重要的狀態改變和錯誤都送出日誌，以便除錯和追蹤。
- [ ] 日誌應包含足夠的上下文信息 (例如：事件類型、時間戳記、相關數據)。

## 5. 其他考量
- [ ] **錯誤處理:** 針對各種可能發生的錯誤 (例如：API 呼叫失敗、儲存失敗、無效的影片 URL) 實作適當的錯誤處理機制。
- [ ] **效能優化:** 確保擴充功能在運行時不會對 YouTube 頁面效能造成顯著影響。
- [ ] **國際化 (I18n):** (可選) 考慮未來支援多語言。
- [ ] **測試:** 為主要功能編寫單元測試和整合測試。
- [ ] **安全性:** 確保擴充功能沒有潛在的安全漏洞，特別是在處理 URL 和使用者數據時。
- [ ] **使用者回饋與迭代:** 準備好根據使用者回饋進行迭代和改進。
